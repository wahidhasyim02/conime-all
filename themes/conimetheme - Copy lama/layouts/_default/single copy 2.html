{{ define "main" }}
<div class="container relative bg-white/80 dark:bg-gray-950/50 backdrop-blur-sm md:dark:bg-gray-950/90 rounded-md backdrop:blur-md md:mx-auto px-2 md:px-4 py-8 grid grid-cols-1 lg:grid-cols-12 gap-8">

  <!-- Artikel Utama -->
  <main class="col-span-12 lg:col-span-8 w-full">
    <article class="prose lg:prose-xl max-w-none w-full p-2">
      <h1 class="font-medium text-3xl mb-2 md:mb-4">{{ .Title }}</h1>

      {{ $path := .RelPermalink }}
      {{ if not (in (slice "/about-us/" "/contact/" "/privacy-policy/" "/terms-of-service/" "/disclaimer/") $path) }}
      <div class="text-sm flex gap-2 justify-between items-center text-gray-600 dark:text-gray-700 mb-4">
        <div class="flex flex-col md:flex-row gap-2 justify-start items-start md:items-center">
          <label class="flex flex-row items-center gap-2">
            {{ range .Params.categories }}
              <a href="{{ "categories/" | relLangURL }}{{ . | urlize }}" class="text-conime-400 hover:underline">{{ . }}</a>
            {{ end }}
          </label>
          <span class="hidden md:inline-block">|</span>
          <div class="flex w-full mx-0 px-0 gap-2 justify-between items-center">
            <div class="w-full">
              {{ with .Params.author }}{{ . }} {{ end }}
              <span class="hidden md:inline-block">|</span>
              {{ partial "date.html" . }}
            </div>
            <div class="flex gap-2 justify-end items-center">
              {{ partial "share-btn.html" . }}
            </div>
          </div>
        </div>
      </div>
      {{ end }}

      <!-- Gambar Utama -->
      {{ if and .Params.image (or .Params.sources .Params.studio) }}
      <figure class="w-full flex flex-col mb-4 bg-gray-100 dark:bg-gray-900/40 rounded-xl">
        <img src="{{ .Params.image | relURL }}" alt="gambar {{ .Title }}" class="h-96 w-full rounded-xl object-cover" />
        <figcaption class="text-sm flex gap-2 px-4 py-4">
          {{ with .Params.sources }}
            {{ $total := len . }}
            {{ range $index, $source := . }}
              {{ if and (gt $index 0) (lt $index (sub $total 1)) }}, {{ end }}
              {{ if eq $index (sub $total 1) }}{{ if gt $index 0 }} {{ end }}{{ end }}
              <a href="{{ $source.url }}" target="_blank" class="text-gray-600 dark:text-gray-700 hover:text-conime-400 hover:underline" rel="noopener noreferrer">{{ $source.name }}</a>
            {{ end }}
          {{ end }}
          {{ with .Params.studio }}
            Image Â© Studio {{ . }}. Used for editorial purposes only.
          {{ end }}
        </figcaption>
      </figure>
      {{ end }}

      <!-- Isi Artikel -->
      <div class="flex flex-col">
        <div class="h-fit font-normal dark:font-light leading-8">{{ .Content }}</div>

        {{ with .Params.synopsis }}
  <h2 class="font-medium">Sinopsis</h2>
  <p class="...">{{ . | safeHTML }}</p>
{{ end }}
 

{{ with .Params.author }}<p>{{ . }}</p>{{ end }}

{{ with .Params.video }}
  <div class="m-8">
    <iframe width="560" height="315"
      src="{{ . }}" 
      title="{{ $.Params.video_title | default "YouTube video player" }}" frameborder="0"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
      allowfullscreen></iframe>

    {{ with $.Params.video_title }}
      <p class="text-sm text-center italic mt-2">{{ . }}</p>
    {{ end }}
  </div>
{{ end }}


{{ with .Params.conclusion }}
  <h2 class="font-medium">Kesimpulan</h2>
  <p class="...">{{ . | safeHTML }}</p>
{{ end }}


          
        {{ with .Params.sources }}
        <p class="mb-4 italic">
          Artikel ini pertama kali dipublikasikan di
          {{ range $index, $source := . }}
            {{ if gt $index 0 }} dan {{ end }}
            <a href="{{ $source.url }}" target="_blank" class="text-gray-900 inline dark:text-gray-400 hover:text-conime-400 hover:underline" rel="noopener noreferrer">{{ $source.name }}</a>
          {{ end }}. 
        </p>
        {{ end }}
      </div>

      {{ partial "terms.html" (dict "taxonomy" "tags" "page" .) }}
      {{ partial "slug-warning.html" . }}

      <!-- Share tombol bawah -->
      <div class="w-full h-fit flex justify-end mt-2">
        <div class="flex gap-2 justify-end items-center">
          {{ partial "share-btn.html" . }}
        </div>
      </div>
    </article>

    <!-- Related Articles -->
    <section class="mt-4 md:mt-12 w-full px-2 md:px-0 border-t border-gray-300 dark:border-gray-800/50 pt-6">
      <h2 class="text-xl uppercase font-medium mb-4">Related Articles</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 md:grid-cols-3 gap-4">
        {{ $related := .Site.RegularPages.Related . | first 6 }}
        {{ range $related }}
<div class="bg-gray-100 dark:bg-gray-950/50 backdrop-blur-sm rounded shadow-lg overflow-hidden">
  <a href="{{ .RelPermalink }}">
    {{ with .Params.image }}
    <img loading="lazy" src="{{ . }}" alt="gambar {{ $.Title }}" class="w-full h-48 object-cover" />
    {{ end }}
    <div class="p-4">
      <h3 class="text-base font-medium line-clamp-2 hover:underline">{{ .Title }}</h3>
      <p class="text-sm text-gray-600 dark:text-gray-700">
        {{ with .Params.author }}{{ . }} {{ end }} | {{ partial "date2.html" . }}
      </p>
    </div>
  </a>
</div>
{{ end }}

      </div>
    </section>
  </main>

  <!-- Modal Share -->
  <div id="shareModal"
    class="fixed hidden left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-50 bg-white dark:bg-gray-950/50 backdrop-blur-sm text-gray-800 dark:text-white p-6 rounded-lg w-fit md:w-[440px] shadow-xl">
    <div id="closeModal" class="absolute right-4 top-4 cursor-pointer">
      <svg class="w-6 h-6 hover:text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
      </svg>
    </div>
    <h3 class="text-lg font-medium mb-4">Share</h3>
    <div class="flex justify-center items-center gap-4">
      <!-- Example share buttons -->
      <a href="https://wa.me/?text={{ .Permalink }}" target="_blank">WhatsApp</a>
      <a href="https://www.facebook.com/sharer/sharer.php?u={{ .Permalink }}" target="_blank">Facebook</a>
      <!-- Add more if needed -->
    </div>
  </div>
</div>
{{ end }}
