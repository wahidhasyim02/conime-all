{{ define "main" }}

<div class="flex flex-col justify-center items-center w-full h-fit sm:px-0 md:px-0 sm:mx-auto md:mx-auto">
  <div
    class="relative p-3 sm:p-6 md:p-6 top-12 sm:top-8 md:top-8 bg-white/0  dark:bg-gray-900/20 rounded backdrop-blur-sm grid grid-rows-2  md:grid-rows-none  md:grid-cols-2 gap-10 ">

    {{/* Ambil semua konten dengan tag "Recommended" dan urutkan dari terbaru */}}
    {{ $recommendedPages := where .Site.RegularPages "Params.tags" "intersect" (slice "Recommended") }}
    {{ $sortedRecommended := sort $recommendedPages "Date" "desc" }}

    {{ if ge (len $sortedRecommended) 1 }}
    {{ $latest := index $sortedRecommended 0 }}
    <!-- Konten utama terbaru -->
    <div class=" row-span-1 sm:col-span-1 md:col-span-1 order-last  md:order-first">
      <div class="">

        <div class="w-full   pr-0 sm:pr-6 md:pr-6  flex flex-col gap-4 sm:gap-3 md:gap-3 ">
          <a href="{{ $latest.RelPermalink }}" class="text-2xl sm:text-4xl md:text-4xl  font-medium hover:underline">{{
            $latest.Title
            }}</a>
          <span class="[&>*:nth-child(2)]:text-conime-400"> {{ partial "date.html" . }}</span>
          <p class="  text-gray-800 dark:text-gray-700">{{ $latest.Summary }}</p>
          <a href="{{ $latest.RelPermalink }}"
            class="self-start mt-4 px-2 py-2 rounded bg-conime-500 flex justify-center group items-center text-white   hover:bg-conime-600 dark:hover:bg-conime-300  transition duration-500 ease-in-out">Baca
            selengkapnya <svg class="w-6 h-auto group-hover:translate-x-2 transition duration-500 ease-in-out"
              viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8.91003 19.9201L15.43 13.4001C16.2 12.6301 16.2 11.3701 15.43 10.6001L8.91003 4.08008"
                stroke="currentColor" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </a>
        </div>
      </div>
    </div>
    {{ end }}


    <div class="row-span-1  md:col-span-1 order-first  md:order-last">
      <div class="relative [&>*:nth-child(1)]:hidden [&>*:nth-child(1)]:md:block  [&>*:nth-child(1)]:sm:block">
        {{ $positions := slice
        (dict "position" "top-0 left-1/2 -translate-x-1/2 sm:left-0 sm:-translate-x-0 sm:top-1/2 sm:-translate-y-1/2 md:left-1/2 md:-translate-x-1/2 sm:-top-10 sm:-right-6 md:-top-10 md:-right-6" "rotate" "rotate-3")
        (dict "position" "top-0 sm:top-2 md:top-2 bottom-12 left-1/2 -translate-x-1/2 sm:left-0 sm:-translate-x-0 sm:top-1/2 sm:-translate-y-1/2 md:left-1/2 md:-translate-x-1/2 " "rotate" "-rotate-6 sm:rotate-6 md:rotate-6")
        (dict "position" "top-6 sm:bottom-6 md:-bottom-6 left-1/2 -translate-x-1/2 sm:left-0 sm:-translate-x-0 sm:top-1/2 sm:-translate-y-1/2 md:left-1/2 md:-translate-x-1/2" "rotate" "rotate-12 sm:-rotate-3 md:-rotate-3")
        (dict "position" "top-12 bottom-0 sm:-bottom-6 sm:top-32 md:-bottom-6 md:top-32 left-1/2 -translate-x-1/2 sm:left-0 sm:-translate-x-0 sm:top-1/2 sm:-translate-y-1/2 md:left-1/2 md:-translate-x-1/2 " "rotate" "rotate-0 sm:rotate-6 md:rotate-6")
        }}

        {{ range $i, $rec := first 4 $sortedRecommended }}
        {{ $style := index $positions $i }}
        {{ partial "recommended-card.html" (dict "page" $rec "position" $style.position "rotate" $style.rotate) }}
        {{ end }}
      </div>
    </div>



  </div>


  <!-- Section Latest Posts -->
  <!-- Ini adalah section untuk menampilkan 3 post terbaru dari setiap kategori -->
  <!-- dengan scroll horizontal -->
  <section
    class="w-full h-fit flex relative border-t  border-gray-300  dark:border-gray-800/50 px-2 md:px-0 flex-col justify-start items-start  mt-20 md:mt-24 pt-6">
    <h2 class="text-xl uppercase   ">Latest Posts</h2>
    <p class="  text-gray-600   dark:text-gray-700 mb-2">Latest posts from all categories</p>
    <!-- Scrollable horizontal list gabungan 3 terbaru dari tiap kategori -->
    <div id="autoScroll"
      class="flex flex-row  gap-4 md:gap-3 py-4   w-full h-fit overflow-x-auto scrollbar-hide scroll-smooth">
      {{ $sections := slice "anime" "movie" "comic" "game" "review" }}
      {{ $all := slice }}

      {{ range $sections }}
      {{ $section := . }}
      {{ $temp := slice }}
      {{ range site.RegularPages }}
      {{ $path := replace .File.Path "\\" "/" }}
      {{ if strings.HasPrefix $path (printf "posts/%s/" $section) }}
      {{ $temp = $temp | append . }}
      {{ end }}
      {{ end }}
      {{ $sorted := sort $temp "Date" "desc" }}
      {{ range first 3 $sorted }}
      {{ $all = $all | append . }}
      {{ end }}
      {{ end }}

      {{ range sort $all "Date" "desc" }}
      <div
        class="relative flex-shrink-0 min-w-[250px] w-[250px] min-h-[398px] flex flex-col group transition duration-500 ease-in-out rounded bg-white  dark:bg-gray-900/20 backdrop-blur-sm h-fit  shadow-none md:shadow-xl  shadow-gray-900/10 hover:shadow-gray-900/20   border border-gray-300 dark:border-gray-800/50">
        <!-- Gambar + Badge -->
        <a href="{{ .RelPermalink }}" class="w-full h-fit rounded z-10 overflow-hidden bg-cover relative">
          <img loading="lazy" src="{{ .Params.image }}" alt="Gambar {{ .Title }}"
            class="w-full h-80 hover:scale-110   brightness-75  hover:brightness-100   transition duration-300    ease-in-out rounded object-cover" />
          <!-- Badge kategori utama -->
          {{ $path := replace .File.Path "\\" "/" }}
          {{ $section := index (split $path "/") 1 }}
          <div class="absolute top-2 left-2 bg-conime-500 text-white text-sm  px-2 py-1 rounded shadow">
            {{ $section | title }}
          </div>
        </a>

        <!-- Info bawah -->
        <div class="p-2     h-full w-full flex flex-col justify-center items-start">

          <a href="{{ .RelPermalink }}" class="  h-[50px] font-medium dark:font-normal mb-2 line-clamp-2 hover:underline">
            {{ .Title }}
          </a>
          {{ partial "timeago.html" . }}
        </div>
      </div>
      {{ end }}
    </div>
  </section>



  <!-- Section Anime -->
  {{ $posts := slice }}
  {{ range site.RegularPages }}
  {{ $path := replace .File.Path "\\" "/" }}
  {{ if strings.HasPrefix $path "posts/anime/" }}
  {{ $posts = $posts | append . }}
  {{ end }}
  {{ end }}

  {{ $posts = sort $posts "Date" "desc" }}

  {{ if gt (len $posts) 0 }}
  <section
    class="relative px-2 flex flex-col justify-center items-start mt-8 md:mt-12 border-t w-full border-gray-300 dark:border-gray-800/50 pt-6">
    <h2 class="text-xl uppercase mb-4">Anime</h2>
    <div
      class="grid grid-cols-2 md:grid-cols-2 md:grid-cols-4 [&>*:nth-child(1)]:col-span-2 [&>*:nth-child(6)]:col-span-2 md:[&>*:nth-child(6)]:col-span-1 md:[&>*:nth-child(1)]:col-span-2 md:[&>*:nth-child(5)]:col-span-2 gap-4 md:gap-3">

      {{ range $i, $post := first 6 (sort $posts "Date" "desc") }}
      {{ $isSpecial := or (eq $i 2) (eq $i 3) }}
      <div
        class="bg-white w-full h-full min-h-[398px] dark:bg-gray-900/20 backdrop-blur-sm overflow-hidden rounded shadow-none md:shadow-xl  shadow-gray-900/10 hover:shadow-gray-900/20  border border-gray-300 dark:border-gray-800/50 transition duration-300 ease-in-out">
        <a href="{{ $post.RelPermalink }}"
          class="bg-cover w-fit h-fit relative  {{ if $isSpecial }} w-full  h-fit md:h-full group {{ end }}">
          {{ with $post.Params.image }}
          <div class="w-full h-56 rounded-t bg-cover overflow-hidden  {{ if $isSpecial }} h-56 md:h-full  {{ end }}">
            <img loading="lazy" src="{{ . }}" alt="Gambar-{{ $post.Title }}"
              class="w-full h-full object-cover rounded-t brightness-75 hover:brightness-100 transition duration-300" />
          </div>
          {{ end }}

          <div
            class="p-2 {{ if $isSpecial }} bg-white/0 dark:bg-gray-950/0 md:bg-white md:dark:bg-gray-900/20 backdrop-blur-sm  opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-in-out md:absolute bottom-0 right-0 left-0 {{ end }}">
            <h3
              class="mb-2 h-[50px] font-medium dark:font-normal hover:underline {{ if $isSpecial }}line-clamp-4  md:text-gray-800  md:dark:text-white {{ else }}line-clamp-2{{ end }}">
              {{ $post.Title }}
            </h3>
            <p
              class="font-normal {{ if $isSpecial }}dark:text-gray-600 text-gray-700 md:text-gray-800  md:dark:text-white {{ else }} dark:text-gray-600 text-gray-700 {{ end }} line-clamp-3 mb-2 ">
              {{ $post.Summary }}</p>
            <p
              class="text-sm {{ if $isSpecial }}dark:text-gray-600 text-gray-700 md:text-gray-800  md:dark:text-white {{ else }} text-gray-600 dark:text-gray-700 {{ end }} line-clamp-1">
              {{ with $post.Params.author }} {{ . }} {{ end }} | {{ partial "date2.html" . }}
            </p>
          </div>
        </a>
      </div>
      {{ end }}
    </div>
    <div class="w-full h-fit flex justify-center items-center mt-4">
      <a href="/posts/anime"
        class="w-full h-fit p-1 text-center bg-conime-50/80 dark:bg-gray-950/60 text-conime-400 hover:underline">
        See full coverage
      </a>
    </div>
  </section>
  {{ end }}




  <!-- Section Comic -->
  {{ $posts := slice }}
  {{ range site.RegularPages }}
  {{ $path := replace .File.Path "\\" "/" }}
  {{ if strings.HasPrefix $path "posts/comic/" }}
  {{ $posts = $posts | append . }}
  {{ end }}
  {{ end }}

  {{ $posts = sort $posts "Date" "desc" }}

  {{ if gt (len $posts) 0 }}
  <section
    class="relative px-2 flex flex-col justify-center items-start mt-8 md:mt-12 border-t w-full border-gray-300 dark:border-gray-800/50 pt-6">
    <h2 class="text-xl uppercase mb-4">Comic</h2>
    <div
      class="grid grid-cols-2 md:grid-cols-2 md:grid-cols-4 md:[&>*:nth-child(3)]:col-span-2 md:[&>*:nth-child(4)]:col-span-2 gap-4 md:gap-3">

      {{ range $i, $post := first 6 (sort $posts "Date" "desc") }}
      {{ $isSpecial := or (eq $i 0) (eq $i 5) }}
      <div
        class="bg-white w-full h-full min-h-[398px] {{ if $isSpecial }} flex flex-col {{ end }} dark:bg-gray-900/20 backdrop-blur-sm overflow-hidden rounded shadow-none md:shadow-xl  shadow-gray-900/10 hover:shadow-gray-900/20  border border-gray-300 dark:border-gray-800/50 transition duration-300 ease-in-out">
        <a href="{{ $post.RelPermalink }}" class="bg-cover w-fit h-fit relative">
          {{ with $post.Params.image }}
          <div class="w-full h-56 rounded-t bg-cover overflow-hidden  {{ if $isSpecial }} md:hidden {{ end }}">
            <img loading="lazy" src="{{ . }}" alt="Gambar-{{ $post.Title }}"
              class="w-full h-full object-cover rounded-t brightness-75 hover:brightness-100 transition duration-300" />
          </div>
          {{ end }}

          <div class="p-2">
            <h3 class="mb-2 h-[50px] font-medium dark:font-normal hover:underline {{ if $isSpecial }}line-clamp-4 {{ else }}line-clamp-2{{ end }}">
              {{ $post.Title }}
            </h3>
            <p class="font-normal  dark:text-gray-600 text-gray-700 line-clamp-3 mb-2 "> {{ $post.Summary }}</p>
            <p class="text-sm text-gray-600 dark:text-gray-700  line-clamp-1">
              {{ with $post.Params.author }} {{ . }} {{ end }} | {{ partial "date2.html" . }}
            </p>
          </div>
        </a>
      </div>
      {{ end }}
    </div>
    <div class="w-full h-fit flex justify-center items-center mt-4">
      <a href="/posts/comic"
        class="w-full h-fit p-1 text-center bg-conime-50/80 dark:bg-gray-950/60 text-conime-400 hover:underline">
        See full coverage
      </a>
    </div>
  </section>
  {{ end }}




  <!-- Section Movie -->
  {{ $posts := slice }}
  {{ range site.RegularPages }}
  {{ $path := replace .File.Path "\\" "/" }}
  {{ if strings.HasPrefix $path "posts/movie/" }}
  {{ $posts = $posts | append . }}
  {{ end }}
  {{ end }}

  {{ $posts = sort $posts "Date" "desc" }}

  {{ if gt (len $posts) 0 }}
  <section
    class="relative px-2 flex flex-col justify-center items-start mt-8 md:mt-12 border-t w-full border-gray-300 dark:border-gray-800/50 pt-6">
    <h2 class="text-xl uppercase mb-4">Movie</h2>
    <div
      class="grid grid-cols-2 md:grid-cols-2 md:grid-cols-4 [&>*:nth-child(1)]:col-span-2 [&>*:nth-child(4)]:col-span-2 md:[&>*:nth-child(1)]:col-span-1  md:[&>*:nth-child(2)]:col-span-2 md:[&>*:nth-child(4)]:col-span-2 gap-4 md:gap-3">

      {{ range $i, $post := first 6 (sort $posts "Date" "desc") }}
      {{ $isSpecial := or (eq $i 0) (eq $i 5) }}
      <div
        class="bg-white w-full h-full min-h-[398px] dark:bg-gray-900/20 backdrop-blur-sm overflow-hidden rounded shadow-none md:shadow-xl  shadow-gray-900/10 hover:shadow-gray-900/20  border border-gray-300 dark:border-gray-800/50 transition duration-300 ease-in-out">
        <a href="{{ $post.RelPermalink }}"
          class="bg-cover w-fit h-fit relative  {{ if $isSpecial }} w-full  h-fit md:h-full group {{ end }}">
          {{ with $post.Params.image }}
          <div class="w-full h-56 rounded-t bg-cover overflow-hidden  {{ if $isSpecial }} h-56 md:h-full  {{ end }}">
            <img loading="lazy" src="{{ . }}" alt="Gambar-{{ $post.Title }}"
              class="w-full h-full object-cover rounded-t brightness-75 hover:brightness-100 transition duration-300" />
          </div>
          {{ end }}

          <div
            class="p-2 {{ if $isSpecial }} bg-white/0 dark:bg-gray-950/0 md:bg-white md:dark:bg-gray-900/20 backdrop-blur-sm  opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-in-out md:absolute bottom-0 right-0 left-0 {{ end }}">
            <h3
              class="mb-2 h-[50px] font-medium dark:font-normal hover:underline {{ if $isSpecial }}line-clamp-4  md:text-gray-800  md:dark:text-white {{ else }}line-clamp-2{{ end }}">
              {{ $post.Title }}
            </h3>
            <p
              class="font-normal {{ if $isSpecial }}dark:text-gray-600 text-gray-700 md:text-gray-800  md:dark:text-white {{ else }} dark:text-gray-600 text-gray-700 {{ end }} line-clamp-3 mb-2 ">
              {{ $post.Summary }}
            </p>
            <p
              class="text-sm {{ if $isSpecial }}dark:text-gray-600 text-gray-700 md:text-gray-800  md:dark:text-white {{ else }} text-gray-600 dark:text-gray-700 {{ end }} line-clamp-1">
              {{ with $post.Params.author }} {{ . }} {{ end }} | {{ partial "date2.html" . }}
            </p>
          </div>
        </a>
      </div>
      {{ end }}
    </div>
    <div class="w-full h-fit flex justify-center items-center mt-4">
      <a href="/posts/movie"
        class="w-full h-fit p-1 text-center bg-conime-50/80 dark:bg-gray-950/60 text-conime-400 hover:underline">
        See full coverage
      </a>
    </div>
  </section>
  {{ end }}


  <!-- Section Game -->
  {{ $posts := slice }}
  {{ range site.RegularPages }}
  {{ $path := replace .File.Path "\\" "/" }}
  {{ if strings.HasPrefix $path "posts/game/" }}
  {{ $posts = $posts | append . }}
  {{ end }}
  {{ end }}

  {{ $posts = sort $posts "Date" "desc" }}

  {{ if gt (len $posts) 0 }}
  <section
    class="relative px-2 flex flex-col justify-center items-start mt-8 md:mt-12 border-t w-full border-gray-300 dark:border-gray-800/50 pt-6">
    <h2 class="text-xl uppercase mb-4">Game</h2>
    <div
      class="grid grid-cols-2 md:grid-cols-2 md:grid-cols-4 [&>*:nth-child(1)]:col-span-2 md:[&>*:nth-child(1)]:col-span-1 md:[&>*:nth-child(2)]:col-span-2 md:[&>*:nth-child(4)]:col-span-2 [&>*:nth-child(6)]:col-span-2 md:[&>*:nth-child(6)]:col-span-1 gap-4 md:gap-3">
      {{ range $i, $post := first 6 $posts }}
      {{ $isSpecial := or (eq $i 0) (eq $i 4) }}
      <div
        class="bg-white w-full h-full min-h-[398px] dark:bg-gray-900/20 backdrop-blur-sm overflow-hidden rounded shadow-none md:shadow-xl  shadow-gray-900/10 hover:shadow-gray-900/20  border border-gray-300 dark:border-gray-800/50 transition duration-300 ease-in-out">
        <a href="{{ $post.RelPermalink }}"
          class="bg-cover w-fit h-fit relative {{ if $isSpecial }} w-full h-fit md:h-full group {{ end }}">
          {{ with $post.Params.image }}
          <div class="w-full h-56 rounded-t bg-cover overflow-hidden {{ if $isSpecial }} h-56 md:h-full {{ end }}">
            <img loading="lazy" src="{{ . }}" alt="Gambar-{{ $post.Title }}"
              class="w-full h-full object-cover rounded-t brightness-75 hover:brightness-100 transition duration-300" />
          </div>
          {{ end }}
          <div
            class="p-2 {{ if $isSpecial }} bg-white/0 dark:bg-gray-950/0 md:bg-white md:dark:bg-gray-900/20 backdrop-blur-sm opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-in-out md:absolute bottom-0 right-0 left-0 {{ end }}">
            <h3
              class="mb-2 h-[50px] font-medium dark:font-normal hover:underline {{ if $isSpecial }}line-clamp-4 md:text-gray-800 md:dark:text-white {{ else }}line-clamp-2{{ end }}">
              {{ $post.Title }}
            </h3>
            <p
              class="font-normal {{ if $isSpecial }}dark:text-gray-600 text-gray-700 md:text-gray-800 md:dark:text-white {{ else }}dark:text-gray-600 text-gray-700{{ end }} line-clamp-3 mb-2">
              {{ $post.Summary }}
            </p>
            <p
              class="text-sm {{ if $isSpecial }}dark:text-gray-600 text-gray-700 md:text-gray-800 md:dark:text-white {{ else }}text-gray-600 dark:text-gray-700{{ end }} line-clamp-1">
              {{ with $post.Params.author }}{{ . }}{{ end }} | {{ partial "date2.html" . }}
            </p>
          </div>
        </a>
      </div>
      {{ end }}
    </div>
    <div class="w-full h-fit flex justify-center items-center mt-4">
      <a href="/posts/game"
        class="w-full h-fit p-1 text-center bg-conime-50/80 dark:bg-gray-950/60 text-conime-400 hover:underline">
        See full coverage
      </a>
    </div>
  </section>
  {{ end }}


  <!-- Section Review -->
  {{/* Ambil semua posts yang memiliki kategori "Review" */}}
  {{ $posts := where site.RegularPages "Params.categories" "intersect" (slice "Review") }}

  {{ if gt (len $posts) 0 }}
  <!-- Section Review -->
  <section
    class="relative px-2 flex flex-col justify-center items-start mt-8 md:mt-12 border-t w-full border-gray-300 dark:border-gray-800/50 pt-6">
    <h2 class="text-xl uppercase mb-4">Review</h2>
    <div
      class="grid grid-cols-2 md:grid-cols-2 md:grid-cols-4 md:[&>*:nth-child(1)]:col-span-2 md:[&>*:nth-child(5)]:col-span-2 gap-4 md:gap-3">
      {{ range $i, $post := first 6 (sort $posts "Date" "desc") }}
      {{ $isSpecial := or (eq $i 2) (eq $i 3) }}
      <div
        class="bg-white w-full h-full min-h-[398px] {{ if $isSpecial }}flex flex-col{{ end }} dark:bg-gray-900/20 backdrop-blur-sm overflow-hidden rounded shadow-none md:shadow-xl  shadow-gray-900/10 hover:shadow-gray-900/20  border border-gray-300 dark:border-gray-800/50 transition duration-300 ease-in-out">
        <a href="{{ $post.RelPermalink }}" class="bg-cover w-fit h-fit relative">
          {{ with $post.Params.image }}
          <div class="w-full h-56 rounded-t bg-cover overflow-hidden {{ if $isSpecial }}md:hidden{{ end }}">
            <img loading="lazy" src="{{ . }}" alt="Gambar-{{ $post.Title }}"
              class="w-full h-full object-cover rounded-t brightness-75 hover:brightness-100 transition duration-300" />
          </div>
          {{ end }}
          <div class="p-2">
            <h3 class="mb-2 h-[50px] font-medium dark:font-normal hover:underline {{ if $isSpecial }}line-clamp-4{{ else }}line-clamp-2{{ end }}">
              {{ $post.Title }}
            </h3>
            <p class="font-normal dark:text-gray-600 text-gray-700 line-clamp-3 mb-2">
              {{ $post.Summary }}
            </p>
            <p class="text-sm text-gray-600 dark:text-gray-700 line-clamp-1">
              {{ with $post.Params.author }}{{ . }}{{ end }} | {{ partial "date2.html" $post }}
            </p>
          </div>
        </a>
      </div>
      {{ end }}
    </div>

    <div class="w-full h-fit flex justify-center items-center mt-4">
      <a href="/categories/review"
        class="w-full h-fit p-1 text-center bg-conime-50/80 dark:bg-gray-950/60 text-conime-400 hover:underline">
        See full coverage
      </a>
    </div>
  </section>
  {{ end }}


</div>

{{ end }}